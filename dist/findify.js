var t=require("react");function e(){return(e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var n={autocomplete:"change:suggestions",recommendation:"change:items",search:"change:items","smart-collection":"change:items"},r=function(){return new Promise(function(t){return(window.findifyCallbacks=window.findifyCallbacks||[]).push(function(e){return t(e)})})};exports.default=function(o){var i=o.type,a=o.config,c=void 0===a?{}:a,s=o.options,u=void 0===s?{}:s,l=o.history,f=o.widgetKey,g=void 0===f?Math.random().toString(36).substring(7):f,d=t.useRef(null),m=t.useState(!1),h=m[0],p=m[1],y=t.useState(!1),v=y[0],w=y[1];return t.useEffect(function(){if(d.current){var t=void 0;return function(){try{Promise.resolve(r()).then(function(r){t=r,l&&(t.utils.history=l);var o=function(t,e,n,r){return"recommendation"!==t?r:n.getIn(["features","recommendations","#"+(r.slot||e.getAttribute("id"))]).mergeDeep(r)}(i,d.current,t.config,e({widgetKey:g,disableAutoRequest:!0},c));t.widgets.attach(d.current,"smart-collection"===i?"search":i,o);var a=t.widgets.get(g),s=e({},a.config.get("meta")&&a.config.get("meta").toJS()||{},u);"recommendation"===i&&(s.slot=c.slot,s.type=c.type||o.get("type")),"smart-collection"===i&&(s.slot=c.slot||t.utils.collectionPath()),a.agent.defaults(s).on("error",function(){return w(!0)}).on(n[i],function t(e){var n=e[0];return window.requestAnimationFrame(function(){a.agent.off(t),n.size||w(!0),p(!0)})}),["search","smart-collection"].includes(i)&&a.agent.applyState(t.utils.getQuery())})}catch(t){return Promise.reject(t)}}(),function(){console.log("detach",g),t.widgets.detach(g)}}},[d]),[d,h,v]},exports.waitForFindify=r;
//# sourceMappingURL=findify.js.map
